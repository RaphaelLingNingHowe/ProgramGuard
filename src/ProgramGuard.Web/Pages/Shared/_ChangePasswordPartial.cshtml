@page
@using ProgramGuard.Dtos.User
@model ProgramGuard.Web.Pages.ChangePasswordModel

@Html.AntiForgeryToken()

<div id="container">

    @(Html.DevExtreme().Popup()
        .ID("changePasswordPopup")
        .Width(400)
        .Height(300)
        .ShowTitle(true)
        .Title("更換密碼")
        .DragEnabled(true)
        .HideOnOutsideClick(true)
        .ShowCloseButton(true)
        .Position(positionConfig => positionConfig
        .At(HorizontalAlignment.Center, VerticalAlignment.Center)
        .My(HorizontalAlignment.Center, VerticalAlignment.Center)
        )
        .ContentTemplate(@<text>
        @using (Html.BeginForm(FormMethod.Post))
        {
        <div class="dx-field">
            <div class="dx-field-label">賬號</div>
            <div class="dx-field-value">
                @(Html.DevExtreme().TextBoxFor(m => m.changePasswordDto.UserName)
                .Placeholder("Enter Username")

                )
            </div>
        </div>
        <div class="dx-field">
            <div class="dx-field-label">密碼</div>
            <div class="dx-field-value">
                @(
                Html.DevExtreme().TextBoxFor(m => m.changePasswordDto.CurrentPassword)
                .ID("Password")
                .Mode(TextBoxMode.Password)
                .InputAttr("aria-label", "Password")
                .Placeholder("現在使用的密碼")
                .ShowClearButton(true)
                .Buttons(buttons =>
                {
                buttons.Add()
                .Name("password")
                .Location(TextEditorButtonLocation.After)
                .Widget(w => w.Button()
                .StylingMode(ButtonStylingMode.Text)
                .Icon("eyeopen")
                .OnClick("() => changePasswordMode('Password')"));
                }))
            </div>
        </div>
        <div class="dx-field">
            <div class="dx-field-label">新密碼</div>
            <div class="dx-field-value">
                @(
                Html.DevExtreme().TextBoxFor(m => m.changePasswordDto.NewPassword)
                .ID("NewPassword")
                .Mode(TextBoxMode.Password)
                .InputAttr("aria-label", "Password")
                .Placeholder("新密碼")
                .ShowClearButton(true)
                .Buttons(buttons =>
                {
                buttons.Add()
                .Name("password")
                .Location(TextEditorButtonLocation.After)
                .Widget(w => w.Button()
                .StylingMode(ButtonStylingMode.Text)
                .Icon("eyeopen")
                .OnClick("() => changePasswordMode('NewPassword')"));
                }))
            </div>
        </div>
        <div class="dx-field">
            <div class="dx-field-label">確認新密碼</div>
            <div class="dx-field-value">
                @(
                Html.DevExtreme().TextBoxFor(m => m.changePasswordDto.ConfirmPassword)
                .ID("ConfirmPassword")
                .Mode(TextBoxMode.Password)
                .InputAttr("aria-label", "Password")
                .Placeholder("重複輸入新密碼")
                .ShowClearButton(true)
                .Buttons(buttons =>
                {
                buttons.Add()
                .Name("password")
                .Location(TextEditorButtonLocation.After)
                .Widget(w => w.Button()
                .StylingMode(ButtonStylingMode.Text)
                .Icon("eyeopen")
                .OnClick("() => changePasswordMode('ConfirmPassword')"));
                }))
            </div>
        </div>
        <div class="dx-field">
            <div class="dx-field-value">
                @(Html.DevExtreme().Button()
                .Text("確定")
                .Type(ButtonType.Success)
                .UseSubmitBehavior(true)
                )
            </div>
        </div>
        }
    </text>)
        )
</div>

<script>
    /* 配合 AntiForgeryToken 使用 */
    $.ajaxSetup({
        data: {
            __RequestVerificationToken: document.getElementsByName("__RequestVerificationToken")[0].value
        }
    });
</script>