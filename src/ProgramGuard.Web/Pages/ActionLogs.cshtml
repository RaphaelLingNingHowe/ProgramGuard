@page
@using ProgramGuard.Dtos.LogQuery
@model ProgramGuard.Web.Pages.ActionLogsModel
@{
}
@{
    ViewData["Title"] = "操作記錄";
}

<!--- Razor 預設開啟 AntiForgeryToken 這個會影響 Post, Put, Patch, Delete 等行為 !--->
@Html.AntiForgeryToken()


<div id="gridContainer">
    @(
        Html.DevExtreme().DataGrid<ActionLogDto>()
        .DataSource(o => o.RemoteController()
        .LoadUrl("ActionLogs?Handler=Data")
        .Key("UserName"))
        .Columns(columns =>
        {
            columns.AddFor(m => m.UserName).Caption("使用者");

            columns.AddFor(m => m.Action).Caption("操作");

            columns.AddFor(m => m.ActionTime).Caption("操作時間").Format("yyyy-MM-dd HH:mm:ss");
        })
        .ShowBorders(true)
        .ColumnAutoWidth(true)
        .Selection(o => o.Mode(SelectionMode.Single))
        .NoDataText("沒有資料")
        .HoverStateEnabled(true)
        .FocusedRowEnabled(true)
        .Paging(paging => paging.PageSize(15))
        .Pager(pager =>
        {
            pager.Visible(true);
            pager.DisplayMode(GridPagerDisplayMode.Full);
            pager.ShowPageSizeSelector(true);
            pager.AllowedPageSizes(new JS("[15, 30, 50, 100, 200]"));
            pager.ShowInfo(true);
            pager.ShowNavigationButtons(true);
        })
        )
</div>

<script>
    /* 配合 AntiForgeryToken 使用 */
    $.ajaxSetup({
        data: {
            __RequestVerificationToken: document.getElementsByName("__RequestVerificationToken")[0].value
        }
    });
</script>